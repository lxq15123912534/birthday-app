<!--index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æ ‡é¢˜åŒºåŸŸ -->
  <view class="header-section">
    <view class="header-decorations">
      <text class="decoration decoration-1">ğŸ‚</text>
      <text class="decoration decoration-2">ğŸˆ</text>
      <text class="decoration decoration-3">ğŸ‰</text>
      <text class="decoration decoration-4">âœ¨</text>
      <text class="decoration decoration-5">ğŸ</text>
    </view>
    <view class="app-title">ğŸŒŸ ç”Ÿæ—¥å®ˆæŠ¤æ˜Ÿ</view>
    <view class="app-subtitle">è®°å½•é‡è¦çš„æ—¥å­ï¼Œæ°¸ä¸é—å¿˜</view>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-wrapper slide-up">
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{isEmpty}}" class="empty-state fade-in">
      <view class="empty-content">
        <view class="empty-icon">ğŸ‚</view>
        <view class="empty-title">å¼€å§‹è®°å½•ç”Ÿæ—¥</view>
        <view class="empty-subtitle">
          æ·»åŠ äº²å‹çš„ç”Ÿæ—¥ä¿¡æ¯<br/>
          è®©æ¯ä¸ªé‡è¦æ—¶åˆ»éƒ½ä¸é”™è¿‡
        </view>
        <view class="gesture-button" bindtap="addBirthday">
          <view class="gesture-hand">
            <view class="hand-emoji">ğŸ‘†</view>
            <view class="gesture-text">ç‚¹å‡»æ·»åŠ </view>
          </view>
          <view class="gesture-sparkles">
            <view class="sparkle sparkle-1">âœ¨</view>
            <view class="sparkle sparkle-2">âœ¨</view>
            <view class="sparkle sparkle-3">âœ¨</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æœ‰æ•°æ®çŠ¶æ€ -->
    <view wx:else class="main-content">
      
      <!-- å³å°†åˆ°æ¥çš„ç”Ÿæ—¥å¡ç‰‡ -->
      <view wx:if="{{upcomingBirthday}}" class="upcoming-section">
        <view class="section-title">
          <text class="icon">ğŸ‰</text>
          å³å°†åˆ°æ¥çš„å¯¿æ˜Ÿ
        </view>
        
        <view class="upcoming-card card" bindtap="viewDetail" data-index="0">
          <view class="upcoming-content">
            <view class="countdown-badge">
              <view class="countdown-number">{{upcomingBirthday.daysLeft}}</view>
              <view class="countdown-unit">å¤©å</view>
            </view>
            
            <view class="birthday-info">
              <view class="name-section">
                <view class="avatar">{{upcomingBirthday.name.substring(0,1)}}</view>
                <view class="name-details">
                  <view class="name">{{upcomingBirthday.name}}</view>
                  <view class="tags">
                    <text wx:for="{{upcomingBirthday.tags}}" wx:key="index" class="tag tag-mini">{{item}}</text>
                  </view>
                </view>
              </view>
              
              <view class="birthday-details">
                <view class="date-info">
                  <text class="icon">ğŸ“…</text>
                  {{upcomingBirthday.month}}æœˆ{{upcomingBirthday.day}}æ—¥
                  <text class="date-type">({{upcomingBirthday.type === 'lunar' ? 'å†œå†' : 'å…¬å†'}})</text>
                </view>
                
                <view class="meta-info">
                  <view class="meta-item">
                    <text class="icon">ğŸ­</text>
                    {{upcomingBirthday.constellation}}
                  </view>
                  <view class="meta-item">
                    <text class="icon">ğŸ²</text>
                    {{upcomingBirthday.zodiac}}
                  </view>
                  <view class="meta-item">
                    <text class="icon">ğŸˆ</text>
                    {{upcomingBirthday.nextBirthdayAge}}å²
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- æœç´¢å’Œç­›é€‰ -->
      <view class="tools-section">
        <view class="search-box">
          <text class="search-icon">ğŸ”</text>
          <input 
            class="search-input" 
            placeholder="æœç´¢å§“åã€æ ‡ç­¾ã€æ˜Ÿåº§..." 
            bindinput="onSearch"
            confirm-type="search"
          />
        </view>
        
        <view class="filter-tags">
          <scroll-view scroll-x="true" class="tags-scroll">
            <view class="tags-container">
              <view 
                class="tag {{currentTag === item ? 'active' : ''}}" 
                wx:for="{{allTags}}" 
                wx:key="index"
                data-tag="{{item}}"
                bindtap="switchTag"
              >
                {{item}}
              </view>
            </view>
          </scroll-view>
        </view>
      </view>

      <!-- ç”Ÿæ—¥åˆ—è¡¨ -->
      <view class="list-section">
        <view class="section-header">
          <view class="section-title">
            <text class="icon">ğŸ“‹</text>
            ç”Ÿæ—¥åˆ—è¡¨
            <text class="count-badge">{{filteredBirthdays.length}}</text>
          </view>
          <view class="add-btn" bindtap="addBirthday">
            <text class="add-btn-icon">ğŸ‚</text>
          </view>
        </view>

        <!-- ç”Ÿæ—¥æ¡ç›® -->
        <view class="birthday-list">
          <view 
            class="birthday-item card" 
            wx:for="{{filteredBirthdays}}" 
            wx:key="index" 
            bindtap="viewDetail" 
            data-index="{{index}}"
          >
            <view class="item-content">
              <view class="item-left">
                <view class="avatar">{{item.name.substring(0,1)}}</view>
                <view class="basic-info">
                  <view class="name">{{item.name}}</view>
                  <view class="birthday-date">
                    {{item.month}}æœˆ{{item.day}}æ—¥
                    <text class="age-info"> Â· {{item.currentAge}}å²</text>
                  </view>
                  <view class="tags-row">
                    <text wx:for="{{item.tags}}" wx:for-item="tag" wx:key="tag" class="tag tag-mini">{{tag}}</text>
                  </view>
                </view>
              </view>
              
              <view class="item-right">
                <view class="days-left">
                  <view class="days-number">{{item.daysLeft}}</view>
                  <view class="days-text">å¤©å</view>
                </view>
                <view class="zodiac-info">
                  <text>{{item.constellation}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

</view>
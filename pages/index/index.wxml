<!--index.wxml-->
<view class="container {{currentTheme ? currentTheme.key + '-theme' : 'classic-theme'}}">

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-wrapper slide-up" style="padding-top: 40rpx;">
    
    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{isEmpty}}" class="empty-state fade-in">
      <view class="empty-content">
        <view class="empty-icon">ğŸ‚</view>
        <view class="empty-title">å¼€å§‹è®°å½•ç”Ÿæ—¥</view>
        <view class="empty-subtitle">
          æ·»åŠ äº²å‹çš„ç”Ÿæ—¥ä¿¡æ¯<br/>
          è®©æ¯ä¸ªé‡è¦æ—¶åˆ»éƒ½ä¸é”™è¿‡
        </view>
        <view class="gesture-button" bindtap="addBirthday">
          <view class="gesture-hand">
            <view class="hand-emoji">ğŸ‘†</view>
            <view class="gesture-text">ç‚¹å‡»æ·»åŠ </view>
          </view>
          <view class="gesture-sparkles">
            <view class="sparkle sparkle-1">âœ¨</view>
            <view class="sparkle sparkle-2">âœ¨</view>
            <view class="sparkle sparkle-3">âœ¨</view>
          </view>
        </view>
      </view>
    </view>

    <!-- æœ‰æ•°æ®çŠ¶æ€ -->
    <view wx:else class="main-content">
      
      <!-- å³å°†åˆ°æ¥çš„ç”Ÿæ—¥å¡ç‰‡ -->
      <view wx:if="{{upcomingBirthday}}" class="upcoming-section">
        <view class="card-base-white">
          <view class="section-title">
            <text class="icon">ğŸ‰</text>
            å³å°†åˆ°æ¥çš„å¯¿æ˜Ÿ
          </view>

          <view class="upcoming-card card special-birthday-card" bindtap="viewDetail" data-index="0">
          <!-- åº†ç¥è£…é¥°èƒŒæ™¯ -->
          <view class="celebration-decorations">
            <view class="confetti confetti-1">ğŸŠ</view>
            <view class="confetti confetti-2">ğŸ‰</view>
            <view class="confetti confetti-3">ğŸˆ</view>
            <view class="confetti confetti-4">âœ¨</view>
            <view class="confetti confetti-5">ğŸ</view>
            <view class="confetti confetti-6">ğŸ‚</view>
          </view>

          <!-- å½©å¸¦è£…é¥° -->
          <view class="ribbon-decoration ribbon-top"></view>
          <view class="ribbon-decoration ribbon-bottom"></view>

          <!-- ç‰¹æ®Šç”Ÿæ—¥æ ‡è¯† -->
          <view class="birthday-crown">ğŸ‘‘</view>

          <view class="upcoming-content-compact">
            <!-- å·¦ä¾§ï¼šå€’è®¡æ—¶åœ†åœˆ -->
            <view class="countdown-section">
              <view class="countdown-circle-compact">
                <view class="countdown-number-compact">{{upcomingBirthday.daysLeft}}</view>
                <view class="countdown-unit-compact">å¤©å</view>
              </view>
              <view class="countdown-sparkles-compact">
                <view class="sparkle sp-1">âœ¨</view>
                <view class="sparkle sp-2">ğŸ’«</view>
                <view class="sparkle sp-3">â­</view>
              </view>
            </view>

            <!-- å³ä¾§ï¼šç”Ÿæ—¥ä¿¡æ¯ -->
            <view class="birthday-info-compact">
              <view class="name-section-compact">
                <view class="avatar-compact">{{upcomingBirthday.zodiacEmoji}}</view>
                <view class="name-details-compact">
                  <view class="birthday-title-compact">ğŸ‚ å³å°†ç”Ÿæ—¥</view>
                  <view class="name-compact">{{upcomingBirthday.name}}</view>
                  <view class="tags-compact">
                    <text wx:for="{{upcomingBirthday.tags}}" wx:key="index" class="tag tag-compact">{{item}}</text>
                  </view>
                </view>
              </view>

              <view class="birthday-details-compact">
                <view class="date-info-compact">
                  <text class="icon-compact">ğŸ¯</text>
                  {{upcomingBirthday.month}}æœˆ{{upcomingBirthday.day}}æ—¥
                  <text class="date-type-compact">({{upcomingBirthday.type === 'lunar' ? 'å†œå†' : 'å…¬å†'}})</text>
                </view>

                <view class="meta-info-compact">
                  <view class="meta-item-compact">
                    <text class="icon-compact">ğŸ­</text>
                    {{upcomingBirthday.constellation}}
                  </view>
                  <view class="meta-item-compact">
                    <text class="icon-compact">ğŸˆ</text>
                    å³å°†{{upcomingBirthday.nextBirthdayAge}}å²
                  </view>
                </view>
              </view>

              <!-- ç”Ÿæ—¥ç¥ç¦æ–‡å­— -->
              <view class="birthday-blessing-compact">
                ğŸŒŸ å‡†å¤‡åº†ç¥è¿™ä¸ªç‰¹åˆ«çš„æ—¥å­å§ï¼
              </view>
            </view>
          </view>
          </view>
        </view>
      </view>

      <!-- æœç´¢ç­›é€‰å’Œç”Ÿæ—¥åˆ—è¡¨ -->
      <view class="search-and-list-section">
        <view class="card-base-white">
          <!-- ç”Ÿæ—¥åˆ—è¡¨æ ‡é¢˜ -->
          <view class="section-header">
            <view class="section-title">
              <text class="icon">ğŸ“‹</text>
              ç”Ÿæ—¥åˆ—è¡¨
              <text class="count-badge">{{filteredBirthdays.length}}</text>
            </view>
            <view class="add-btn" bindtap="addBirthday">
              <text class="add-btn-icon">â•</text>
              <text class="add-btn-text">æ·»åŠ </text>
            </view>
          </view>

          <!-- æœç´¢å’Œç­›é€‰ -->
          <view class="tools-section">
            <view class="search-box">
              <text class="search-icon">ğŸ”</text>
              <input
                class="search-input"
                placeholder="æœç´¢å§“åã€æ ‡ç­¾ã€æ˜Ÿåº§..."
                bindinput="onSearch"
                confirm-type="search"
              />
            </view>

            <view class="filter-tags">
              <scroll-view scroll-x="true" class="tags-scroll">
                <view class="tags-container">
                  <view
                    class="tag {{currentTag === item ? 'active' : ''}}"
                    wx:for="{{allTags}}"
                    wx:key="index"
                    data-tag="{{item}}"
                    bindtap="switchTag"
                  >
                    {{item}}
                  </view>
                </view>
              </scroll-view>
            </view>
          </view>

          <!-- ç”Ÿæ—¥åˆ—è¡¨å†…å®¹ -->
          <view class="list-content">

        <!-- ç”Ÿæ—¥æ¡ç›® -->
        <view class="birthday-list">
          <view 
            class="birthday-item card" 
            wx:for="{{filteredBirthdays}}" 
            wx:key="index" 
            bindtap="viewDetail" 
            data-index="{{index}}"
          >
            <view class="item-content">
              <view class="item-left">
                <view class="avatar">{{item.zodiacEmoji}}</view>
                <view class="basic-info">
                  <view class="name">{{item.name}}</view>
                  <view class="birthday-date">
                    {{item.month}}æœˆ{{item.day}}æ—¥
                    <text class="age-info"> Â· {{item.currentAge}}å²</text>
                  </view>
                  <view class="tags-row">
                    <text wx:for="{{item.tags}}" wx:for-item="tag" wx:key="tag" class="tag tag-mini">{{tag}}</text>
                  </view>
                </view>
              </view>
              
              <view class="item-right">
                <view class="days-left">
                  <view class="days-number">{{item.daysLeft}}</view>
                  <view class="days-text">å¤©å</view>
                </view>
                <view class="constellation-info">
                  <text>{{item.constellation}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
          </view>
        </view>
      </view>
    </view>
  </view>

</view>
<!--pages/profile/profile.wxml-->
<view class="container {{currentTheme && currentTheme.key ? currentTheme.key + '-theme' : 'classic-theme'}}">
  <!-- 顶部个人信息区域 -->
  <view class="profile-header">
    <view class="profile-card">
      <view class="avatar-section" bindtap="selectAvatar">
        <view class="avatar-wrapper">
          <text class="avatar-emoji">{{userInfo.avatar || '🐱'}}</text>
          <view class="avatar-edit-icon">✏️</view>
        </view>
      </view>
      
      <view class="user-info">
        <view class="nickname" bindtap="editNickname">
          {{userInfo.nickname || '生日守护者'}}
          <text class="edit-icon">✏️</text>
        </view>
        <view class="user-desc">记录每一个重要时刻</view>
      </view>
    </view>
  </view>

  <!-- 功能设置区域 -->
  <view class="content-wrapper">
    
    <!-- 个性化设置 -->
    <view class="settings-section">
      <view class="section-title">🎨 个性化设置</view>
      
      <view class="setting-item" bindtap="selectTheme">
        <view class="item-left">
          <text class="item-icon">🎭</text>
          <text class="item-label">主题风格</text>
        </view>
        <view class="item-right">
          <text class="item-value">{{currentTheme.name}}</text>
          <text class="arrow">›</text>
        </view>
      </view>
    </view>

    <!-- 数据管理 -->
    <view class="settings-section">
      <view class="section-title">📦 数据管理</view>
      
      <view class="setting-item" bindtap="exportData">
        <view class="item-left">
          <text class="item-icon">📤</text>
          <text class="item-label">导出生日数据</text>
        </view>
        <view class="item-right">
          <text class="arrow">›</text>
        </view>
      </view>
      
      <view class="setting-item" bindtap="importData">
        <view class="item-left">
          <text class="item-icon">📥</text>
          <text class="item-label">导入生日数据</text>
        </view>
        <view class="item-right">
          <text class="arrow">›</text>
        </view>
      </view>
    </view>

    <!-- 关于应用 -->
    <view class="settings-section">
      <view class="section-title">ℹ️ 关于应用</view>
      
      <view class="setting-item">
        <view class="item-left">
          <text class="item-icon">📱</text>
          <text class="item-label">版本号</text>
        </view>
        <view class="item-right">
          <text class="item-value">1.0.0</text>
        </view>
      </view>
      
      <view class="setting-item">
        <view class="item-left">
          <text class="item-icon">💝</text>
          <text class="item-label">应用简介</text>
        </view>
        <view class="item-right">
          <text class="item-value">生日守护星</text>
        </view>
      </view>
    </view>
    
  </view>
</view>

<!-- 头像选择弹窗 -->
<view class="modal-overlay" wx:if="{{showAvatarModal}}" bindtap="hideAvatarModal">
  <view class="avatar-modal" catchtap="">
    <view class="modal-title">选择头像</view>
    <view class="avatar-grid">
      <view 
        class="avatar-option {{item === userInfo.avatar ? 'selected' : ''}}"
        wx:for="{{avatarList}}"
        wx:key="index"
        data-avatar="{{item}}"
        bindtap="chooseAvatar"
      >
        {{item}}
      </view>
    </view>
  </view>
</view>

<!-- 昵称编辑弹窗 -->
<view class="modal-overlay" wx:if="{{showNicknameModal}}" bindtap="hideNicknameModal">
  <view class="nickname-modal" catchtap="">
    <view class="modal-title">编辑昵称</view>
    <input 
      class="nickname-input" 
      value="{{tempNickname}}"
      bindinput="onNicknameInput"
      placeholder="请输入昵称"
      maxlength="20"
      focus="{{showNicknameModal}}"
    />
    <view class="modal-actions">
      <button class="modal-btn cancel" bindtap="hideNicknameModal">取消</button>
      <button class="modal-btn confirm" bindtap="saveNickname">确定</button>
    </view>
  </view>
</view>

<!-- 主题选择弹窗 -->
<view class="modal-overlay" wx:if="{{showThemeModal}}" bindtap="hideThemeModal">
  <view class="theme-modal" catchtap="">
    <view class="modal-title">选择主题</view>
    <view class="theme-list">
      <view 
        class="theme-item {{item.key === currentTheme.key ? 'selected' : ''}}"
        wx:for="{{themeList}}"
        wx:key="key"
        data-theme="{{item}}"
        bindtap="chooseTheme"
      >
        <view class="theme-preview" style="background: {{item.gradient}}"></view>
        <view class="theme-info">
          <view class="theme-name">{{item.name}}</view>
          <view class="theme-desc">{{item.desc}}</view>
        </view>
        <view class="theme-check" wx:if="{{item.key === currentTheme.key}}">✓</view>
      </view>
    </view>
  </view>
</view>